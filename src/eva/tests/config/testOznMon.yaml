# Test OznMon

diagnostics:

  # Data read
  # ---------
- data:
    datasets:
      - name: experiment
        type: MonDataSpace
        satellite: aura
        sensor: omi
        control_file:
#          - ${data_input_path}/omi_aura.ges.ctl
#          - ../data/ozn_data/omi_aura.ges.ctl
          - ../data/ozn_data/ompsnp_npp.ges.ctl
        filenames:
          - ../data/ozn_data/ompsnp_npp.ges.2023050100.ieee_d
          - ../data/ozn_data/ompsnp_npp.ges.2023050106.ieee_d
          - ../data/ozn_data/ompsnp_npp.ges.2023050112.ieee_d
          - ../data/ozn_data/ompsnp_npp.ges.2023050118.ieee_d

#          - ../data/ozn_data/omi_aura.ges.2023050100.ieee_d
#          - ../data/ozn_data/omi_aura.ges.2023050106.ieee_d
#          - ../data/ozn_data/omi_aura.ges.2023050112.ieee_d
#          - ../data/ozn_data/omi_aura.ges.2023050118.ieee_d

        regions: &regions 1
        groups:
          - name: GsiIeee
            variables: ['cnt', 'cycle']
        levels: &levels 18

#  transforms:
#    - transform: select time
#      new name: experiment::GsiIeee::count1
#      starting field: experiment::GsiIeee::count
#      cycle: 2015051418
#      for:
#        variable: [none]
#
#    - transform: select time
#      new name: experiment::GsiIeee::count2
#      starting field: experiment::GsiIeee::count
##      cycles: 2015051500
#      cycle: 2015051500
#      for:
#        variable: [none]
#
#    - transform: select time
#      new name: experiment::GsiIeee::count3
#      starting field: experiment::GsiIeee::count
##      cycles: 2015051506
#      cycle: 2015051506
#      for:
#        variable: [none]
#
#    - transform: select time
#      new name: experiment::GsiIeee::count4
#      starting field: experiment::GsiIeee::count
##      cycles: 2015051512
#      cycle: 2015051512
#      for:
#        variable: [none]
#
#    # Note that total is the total bias correction for a given
#    # channel/region.  To find the average divide total by count.
#    - transform: arithmetic
#      new name: experiment::GsiIeee::total_avg
#      equals: experiment::GsiIeee::total/experiment::GsiIeee::count
#      for:
#        variable: [none]
#
#    # Single cycle total bias correction 
#    - transform: select time
#      new name: experiment::GsiIeee::total_1cyc
#      starting field: experiment::GsiIeee::total_avg
#      cycle: 2015051512
#      for:
#        variable: [none]
#
#     # 4 cycle total bias correction using time slice    
#    - transform: select time
#      new name: experiment::GsiIeee::cnt_4cyc
#      starting field: experiment::GsiIeee::cnt
#      start cycle: 2023033012
#      end cycle: 2023033106
#      for:
#        variable: [none]


  graphics:
    # Summary plots
    # ---------------
      - figure:
          layout: [1,1]
          figure size: [12,10]
#          title: 'omi_aura | ges | Number of Obs Count'
          title: 'ompsnp_npp | ges | Number of Obs Count'
          output name: lineplots/ompsnp_npp/time.ompsnp_npp.png

        plots:
          - add_xlabel: 'Cycle'
            add_ylabel: 'Observation Count'
            add_legend:
              loc: 'upper right'
            layers:
            - type: LinePlot
              x:
                variable: experiment::GsiIeee::cycle
              y:
                variable: experiment::GsiIeee::cnt
              color: 'blue'
              label: 'cnt'
#            - type: LinePlot
#              x:
#                variable: experiment::GsiIeee::channel
#              y:
#                variable: experiment::GsiIeee::count2
#              color: 'green'
#              label: '2015051500'
#            - type: LinePlot
#              x:
#                variable: experiment::GsiIeee::channel
#              y:
#                variable: experiment::GsiIeee::count3
#              color: 'yellow'
#              label: '2015051506'
#            - type: LinePlot
#              x:
#                variable: experiment::GsiIeee::channel
#              y:
#               variable: experiment::GsiIeee::count4
#              color: 'red'
#              label: '2015051512'
#
#          - add_xlabel: 'Channel'
#            add_ylabel: 'Total Bias Correction (K)'
#            add_legend:
#              loc: 'upper right'
#            layers:
#            - type: LinePlot
#              x:
#                variable: experiment::GsiIeee::channel
#              y:
#                variable: experiment::GsiIeee::total_1cyc
#              color: 'blue'
#              label: '2015051512'
#
#            - type: LinePlot
#              x:
#                variable: experiment::GsiIeee::channel
#              y:
#                variable: experiment::GsiIeee::total_4cyc
#              color: 'red'
#              label: 'Avg last 4 cycles'
